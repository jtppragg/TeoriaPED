---

marp: true
size: 16:9
paginate: true
footer: (c) 2020 Gorka Prieto
style: |
    section {font-size: 18pt}
    section::before {content: "Tema 1: Intro a POO en Java"};

---

Programaci√≥n en Entornos Distribuidos{.h1}

Tema 1: Introducci√≥n a la Programaci√≥n Orientada a Objetos (POO) en Java{.h2}

<br/>

{.line}

<br/>

2¬∫ Ingenier√≠a en Tecnolog√≠a de Telecomunicaci√≥n (UPV/EHU){.s3}

Curso 2020/2021{.s3}

---

Licencia de uso{.h1}

¬©2019-2021, Gorka Prieto Agujeta <<gorka.prieto@ehu.eus>>

Este documento est√° derivado de documentos anteriores desarrollados por Jose Daniel Guti√©rrez Porset, Gaizka Abaroa Erkoreka y Javier del Ser Lorente.

Se otorga permiso para copiar, distribuir y/o modificar este documento bajo los t√©rminos de la Licencia de Documentaci√≥n Libre de GNU en su versi√≥n 1.2 o cualquier otra versi√≥n posterior publicada por la Free Software Foundation, siendo todo √©l invariante. Una copia de la licencia est√° disponible en la web de la Free Software Foundation, dentro de la secci√≥n titulada GNU Free Documentation License.

---

√çndice{.h1}

:::columns
@[toc]
:::

---

# Paradigmas de Programaci√≥n
## Introducci√≥n
- Paradigma: manera de programar
- Principales paradigmas de programaci√≥n:
    - __Imperativa__ ü†ñ describir el _"c√≥mo"_:
        - Procedural (ej. C) ü†ñ control de flujo, funciones y estructuras de datos
        - __Orientada a Objetos (POO)__:
            - Objetos con atributos (estado) y m√©todos (operaciones)
            - Noci√≥n del propio objeto (this/self)
            - __Orientado a clases__ (ej. Java) vs orientado a instancias (ej. JavaScript)
    - Declarativa ü†ñ describir el _"qu√©"_:
        - Funcional, l√≥gica, matem√°tica, etc.
- La mayor√≠a de los lenguajes de programaci√≥n m√°s populares son multi-paradigma:
    - __Java__, C++, C#, JavaScript, Python, Kotlin, Swift, etc.

---

## Programaci√≥n Orientada a Objetos (POO)

Orientado a clases{.h2}

- __Clases__:
    - "Plantilla"
    - Define atributos y m√©todos que pueden acceder a ellos
- __Objetos__:
    - Instancia de una clase
    - Atributos con valores concretos

![bg right fit](https://3.bp.blogspot.com/-5ClB9-r6rR0/XE8swymyD3I/AAAAAAAAB-A/Cw0j_xuhM1kPhbXO6vXZZLfxh_rbhlqXgCK4BGAYYCw/s1600/052016_0704_ObjectsandC6.jpg)

---
# Plataforma Java
## Introducci√≥n
- Java surgi√≥ en 1991, inicialmente destinado a la programaci√≥n de electrodom√©sticos.
- Objetivo importante: c√≥digo ‚Äúneutro‚Äù que se pueda ejecutar sobre una m√°quina virtual denominada __Java Virtual Machine (JVM)__ que _interpreta_ el c√≥digo neutro convirti√©ndolo a c√≥digo particular de la CPU utilizada.
- Caracter√≠stica ___‚ÄúWrite Once, Run Everywhere‚Äù___

![bg right:40% width:100%](https://www.sawakinome.com/img/images_1/difference-between-source-code-and-bytecode.png)

---
## Popularidad
![](https://images3.programmersought.com/524/0c/0cb0a091837fc4eeff76a485c8fd9534.png)

---
## Componentes
### Java Development Kit (JDK)
- Necesario para programar
- JRE + herramientas desarrollo:
    - javac, jshell, javadoc, etc.

### Java Runtime Environment (JRE)
- Necesario para ejecutar
- Java Virtual Machine (JVM)
- Librer√≠as (API de Java) 
![bg right:55% width:100%](https://miro.medium.com/max/636/1*8oNn6HxcWFmrCsgUt27k0w.jpeg)

---
### Java Virtual Machine (JVM)
- Carga c√≥digo en tiempo de ejecuci√≥n seg√∫n se necesita (_class loader_)
- Int√©rprete y compilador just-in-time (JIT) para mejorar rendimiento
- Gesti√≥n de memoria:
    - Recolector de basura (GC) libera memoria cuando no se neceista
    - Ya no usamos punteros! ... pero s√≠ referencias
- Verifica c√≥digo, l√≠mites de arrays, excepciones, etc.
- Gesti√≥n de hilos, sincronizaci√≥n, etc.
![bg right:40% width:100%](https://res.infoq.com/articles/OpenJDK-HotSpot-What-the-JIT/en/resources/1fig1.jpg)

---
## Ediciones
- Java Card:
    - Smart cards, tarjetas SIM, etc.
- Java ME (Micro Edition)
    - Dispositivos con capacidades de memoria/potencia/bater√≠a reducidas
    - M√≥viles, TV, etc.
- __Java SE__ (Standard Edition)
    - Prop√≥sito general (ej. PC escritorio)
    - Actualmente:
        - __Java SE 11__ LTS (sept. 2018)
        - Java SE 15 (sept. 2020)
        - Mayor compatibilidad ü†ñ __Java SE 8__ LTS (mar. 2014)
- Java EE (Enterprise Edition)
    - Aplicaciones empresariales multinivel (ej. servidores)
    - Actualmente Java EE 8 (ago. 2017) / Jakarta EE 8 (sept. 2019)

![bg right:20% vertical 50%](https://www.oracle.com/ocom/groups/public/@otn/documents/digitalasset/5253185.png)
![bg fit](https://i0.wp.com/www.ebizlatam.com/wp-content/uploads/2017/10/Logo-Java.jpg?fit=510%2C374)
![bg fit](https://www.imaginae.net/wp-content/uploads/2018/03/java_ee_logo_vert_v2.png)

---
## Implementaciones

- OpenJDK (Oracle):
    - Implementaci√≥n de referencia oficial desde Java 7
    - JVM: HotSpot
- Eclipse:
    - JVM: OpenJ9

Instalaci√≥n sencilla con [AdoptOpenJDK](https://adoptopenjdk.net/)

![bg height:80px](https://openjdk.java.net/images/openjdk.png)
![height:80px](https://openwebstart.com/wp-content/uploads/2020/06/AdoptOpenJDK.png)

---
# Lenguaje Java

## Principales diferencias con C
- No tiene preprocesado ni ficheros de cabecera
- No hay estructuras (se usan clases)
- No hay variables ni funciones "sueltas" (globales), todo tiene que estar dentro de una clase
- Gesti√≥n de memoria autom√°tica (‚Äúgarbage collector‚Äù).
- No hay notaci√≥n de punteros, se usan referencias
- No es posible acceder a elementos fuera de rango (strings y array)
- Es m√°s seguro
- Pero ... es m√°s lento
    - Tecnolog√≠as JIT para mejorar rendimiento.

![bg right:40% fit](https://careerkarma.com/blog/wp-content/uploads/2019/12/java-vs-c.jpg)

---

## Variables y constantes

### Declaraci√≥n

`[modificadores ...] tipo identificador [= valor];`

- Tipo: diferenciamos entre tipos **primitivos** y **referencia**
- Identificador:
    - Comenzar por letra, v√°lidos caracteres Unicode
    - Recomendado camelCase para variables
- Valor inicial:
    - Literal u otra variable (objeto)
    - Desde Java 10 `var` deduce el tipo a partir del valor inicial dado
- Modificadores (public, private, static, final, etc.):
    - Indican √°mbito de acceso, si puede cambiar el valor o no, etc.

```java
int numeroPuertas = 4;
```

---

### Constantes

- Modificador **final**:
    - Una vez asignado un valor a la variable (en la declaraci√≥n o en el constructor) no se puede reasignar
- Modificador **static**:
    - Una √∫nica instancia para todos los objetos de la clase (veremos m√°s adelante)
- Nomenclatura:
    - Recomendado may√∫sculas separadas por gui√≥n bajo
- Comparaci√≥n con C:
    - En C no hay constantes, se usa `#define` para substituir por el preprocesador
    - Ahora las constantes tienen tipo (y se comprueba al asignar un valor)

```java
static final int NUMERO_PUERTAS = 4;
``` 

---

### √Åmbito

- **Local** a un m√©todo:
    - √Åmbito de vida igual al m√©todo
    - No inicializadas por defecto ==> error de compilaci√≥n si se intenta usar sin inicializar
- **Par√°metro** de un m√©todo (o de un `catch`):
    - √Åmbito de vida igual al m√©todo (o bloque `catch`)
    - Inicilizadas con el valor de la llamada al m√©todo
- **Atributo**:
    - Objeto ==> √°mbito de vida del objeto
    - Clase (modificador `static`) ==> √°mbito de vida de la clase (todos los objetos)
    - Inicializados autom√°ticamente con valor por defecto
- ~~Globales~~: no existen

---

## Tipos de datos

- Java es un lenguaje de **tipado est√°tico** ==> todas las variables tienen que ser declaradas antes de usarse y s√≥lo pueden contener valores del tipo indicado.
- Los tipos **primitivos** forman parte del lenguaje y no son objetos de un clase. Guardan directamente un valor y se pueden inicializar con un **literal**^1^:
    ```java
    int contador = 3;
    ```
- Los tipos **referencia** guardan la direcci√≥n de memoria de un objeto, que en alg√∫n momento se habr√° construido a partir de una clase haciendo un `new`:
    ```java
    Alumno alumno = new Alumno();
    ```
- El tipo `String` es un caso especial de tipo referencia ya que se puede inicilizar con un literal (adem√°s del `new`):
    ```java
    String nombre = "Gorka";
    ```

:::note
^1^ Representaci√≥n en c√≥digo fuente de un valor fijo, no requiere de computaci√≥n.
:::

---

<style scoped>
section {display: block;}
table {font-size: 14pt;}
</style>

### Tipos primitivos

|tipo|tama√±o|comentario|rango|valor por defecto|ejemplo de literales|
|---|---:|---|:---:|---:|:---|
|byte|1 byte|Con signo|-128 ... 127|`0`|`-2`|
|char|2 bytes|Unicode UTF-16, sin signo|`'\u0000'` ... `'\uffff'`|`'\u0000'`|`'x'`, `'\n' `, `'\t' `, `'\u0108'`, `'"'`, `'\''`, `'\\'`|
|short|2 bytes|Con signo|-32,768 ... 32,767|`0`|`10000`|
|int|4 bytes|Con signo^1^|-2^31^ ... 2^31^-1|`0`|`100000`, `O32` (octal), `0x1F` (hexadecimal)|
|long|8 bytes|Con signo^1^|-2^63^ ... 2^63^-1|`0L`|`3L`, `3123456789`|
|float|4 bytes|No preciso^2^|IEEE 754|`0.0f`|`123.4f`, `12.4F`|
|double|8 bytes|No preciso^2^|IEEE 754|`0.0d`|`12.3`, `-124.23D`, `1.23e4`
|boolean|1&nbsp;bit&nbsp;√≥&nbsp;1&nbsp;byte|Verdadero/falso|`true`\|`false`|`false`|`true`, `false`

:::note
^1^ Desde Java SE 8 se pueden usar las clases `Number` para operar sin signo (`Integer` y `Long`)
^2^ Si se requiere precisi√≥n (ej.: cantidad monetaria) usar `BigDecimal`
:::

---

### Tipos referencia

Profundizaremos en ellos en el siguiente tema, pero adelanto algunos conceptos:

- Una variable de tipo referencia guarda la direcci√≥n de un objeto (instancia de una clase) y ocupa el n√∫mero de bytes necesarios para almacenar la direcci√≥n (depende de la arquitectura de la m√°quina)
- Su valor por defecto (cuando sea aplicable) es `null`, que es una palabra reservada para indicar que no se ha guardado ninguna direcci√≥n de memoria
- S√≥lo pueden guardar valores de un tipo (con la salvedad de la herencia y el polimorfismo):
    ```java
    Computer pc = new Computer();
    Computer ordenador = pc;    // CORRECTO
    
    String nombre = "Workstation";
    pc = nombre;    // ERROR de compilaci√≥n
    ```
- El tipo `String` as√≠ como los arrays son tipos referencia que apuntan a objetos

---

## Operadores

### Comparaci√≥n con C

:::columns
- V√°lidos mayor√≠a de operadores de C: `+`, `-`, `*`, `/`, `++`, `*=`, `?:`, etc.    
    ```java
    int max = a > b ? a : b;
    ```
    ```java
    int max;
    if( a > b )
        max = a;
    else
        max = b;
    ```
- Desaparecen:
    - Operadores de punteros y memoria: `*`, `&`, `->`, `sizeof`
    - Operador `,` en las sentencias for
- Aparece nuevo `instanceof`:
    - Operador binario para saber si un objeto es de un tipo determinado
    - Devuelve un `boolean`
- Operadores de casting:
    - En los tipos primitivos obligatorio si se va a perder precisi√≥n
    - `boolean` no es convertible a otro tipo con casting
    - En los tipos referencia seg√∫n reglas de herencia y polimorfismo    
:::

---

### Tabla de precedencia de operadores (de mayor a menor prioridad)

:::columns
|Tipo|Operador|
|---|---|
|acceso y par√©ntesis|`[] . ()`|
|sufijo|`expr++ expr--`|
|unario|`++expr --expr +expr -expr ~ !`|
|multiplicativo|`* / %`|
|aditivo|`+ -`|
|desplazamiento|`<< >> >>>`|
|relacional|`< > <= >= instanceof`|
|igualdad|`== !=`|
|AND de bits|`&`|
|OR exclusivo de bits|`^`|
|OR inclusivo de bits|`|`|
|AND l√≥gico|`&&`|
|OR l√≥gico|`||`|
|ternario|`? :`|
|asignaci√≥n|`= += -= *= /= %= &= ^= |= <<= >>= >>>=`|
:::

---

## Sentencias de control de flujo

- Condicionales: `if-then`, `if-then-else`, `switch`
    - Ejecutan una sola vez una o `{ ` varias l√≠neas de c√≥digo `}` dependiendo de una condici√≥n
    - La condici√≥n tiene que ser un `boolean` a diferencia de C/C++ donde verdadero es cualquier valor distinto de cero
- Repetitivas: `for` (y _foreach_), `while`, `do-while`
    - Ejecutan cero, una o varias veces
    :::columns
    ```java
    public class EjemploFor {
	    public static void main(String[] args) {
            System.out.println("Usando for:");
            for( int i = 0; i < args.length; i++ )
                System.out.println(i + ": " + args[i]);
	    }
    }
    ```    
    ```java
    public class EjemploForeach {
	    public static void main(String[] args) {
            System.out.println("\nUsando foreach:");
            for( String arg : args )
                System.out.println(arg);
	    }
    }
    ```
    :::
- Ramificaci√≥n: `break`, `continue`, `return`
    - Permiten saltos en el orden de ejecuci√≥n de instrucciones

---

<style scoped>
table {font-size: 16pt;}
</style>

## Funciones

- Una funci√≥n no puede estar "suelta", sino dentro de una clase (**m√©todo**)
- Paso de argumentos por **valor** (copia), pero en los tipos referencia lo que se copia es la direcci√≥n del objeto, no su valor!
    - Otra forma de verlo ==> los tipos primitivos se pasan por valor y los objetos por referencia
    - Sin sintaxis especial tipo punteros de C
- Permitida **sobrecarga** de m√©todos:
    - Diferentes m√©todos con un mismo nombre pero que se diferencian por el n√∫mero y/o tipo de argumentos:
    
|Ejemplo C|Ejemplo Java|
|---|---|
|`void mostrarInt(int num)`|`void mostrar(int num)`|
|`void mostrarLong(int num)`|`void mostrar(long num)`|
|`void mostrarFloat(int num)`|`void mostrar(float num)`|

---

# Primer programa

## Ejemplo: hola mundo

:::columns
1. Edici√≥n del **c√≥digo** fuente (*.java)    
    ```shell
    $ nano HolaJava.java
    ```
    ```java
    public class HolaJava {
        public static void main( String args[] ) {
            System.out.println( "¬°Hola Java!" );
        }
    }
    ```
1. **Compilaci√≥n** (*.java ==> *.class)
    ```shell
    $ javac HolaJava.java
    ```
1. **Ejecuci√≥n** (*.class)
    ```shell
    $ java HolaJava
    $ java paquete.HolaJava
    ```
:::

- En Java SE 11 se puede compilar y ejecutar a la vez:
    ```shell
    $ java HolaJava.java
    ```
- ¬°Importante! el **nombre del fichero** *.java tiene que coincidir con el de la clase p√∫blica

---

## Entrada/salida mediante flujos

- En Java se define la abstracci√≥n **stream** (flujo) para el tratamiento de la comunicaci√≥n entre el programa y los dispositivos externos
- Tres flujos creados por defecto:
    - `System.in`: objeto de tipo `InputStream` para la entrada est√°ndar (`stdin` en C)
    - `System.out`: objeto de tipo `PrintStream` para la salida est√°ndar (`stdout` en C)
    - `System.err`: objeto de tipo `PrintStream` para la salida de error (`stderr` en C)
- La clase `PrintStream` ofrece diferentes m√©todos para imprimir texto por pantalla:
    - `print()`, `println()`, `printf()`, etc.
- Para leer de la entrada est√°ndar nos ayudamos de los m√©todos de la clase `Scanner`:
    - `next()`, `nextLine()`, `nextInt()`, etc.

---

## Ejemplo: lectura de teclado

```java
import java.util.Scanner;

public class HolaTeclado {
    public static void main( String args[] ) {
        Scanner sc = new Scanner(System.in);
        String nombre;
        int edad;

        System.out.print( "Dime tu nombre: " );
        nombre = sc.nextLine();

        System.out.print( "Dime tu edad: " );
        edad = sc.nextInt();

        System.out.printf( "Hola %s, tienes %d a√±os\n", nombre, edad);
    }
}
```

---

## Consideraciones con respecto a C

- M√©todo **main** ==> dentro de una clase
- **public** ==> para que se pueda acceder desde fuera de la clase
- **static** ==> m√©todo de clase, no de objeto
- Nombre del **fichero** ==> igual que la clase
- **import** ==> ‚â† include (de C)
- System.out
    - `print()`, `println()`, `printf()`
- System.in
    - `java.util.Scanner`
- Paquetes

... siguientes temas{.h2 .right}
